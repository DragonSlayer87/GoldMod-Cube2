//here standart events' handlers are described

//------ onconnect [cn] ------//
irc_onconnect = [ ircsay (format "^f1>>> ^f2Connect: ^f4Name(cn): ^f2%1(%2) ^f4connected from ^f2%3^f4. ^f1<<<" (getname $arg1) $arg1 (getcountry (getip $arg1))) ] 
addhandler onconnect irc_onconnect

log_onconnect = [ log (format ">>> Connect: %1(%2) connected from %3. <<<" (getname $arg1) $arg1 (getip $arg1)) ]
addhandler onconnect log_onconnect


//------ ondisconnect [cn] ------//
irc_ondisconnect = [ ircsay (format "^f1>>> ^f2Disconnect: ^f4Name(cn): ^f2%1(%2) ^f4- ^f4Left after: ^f2%3 ^f4minutes. ^f3<<<" (getname $arg1) $arg1 (formatmillis "%hh %mm %ss" (getonline $arg1))) ]
addhandler ondisconnect irc_ondisconnect

log_ondisconnect = [ log (format ">>> Disconnect: Name(cn): %1(%2) - Left after: %3 minutes. <<<" (getname $arg1) $arg1 (formatmillis "%hh %mm %ss" (getonline $arg1))) ]
addhandler ondisconnect log_ondisconnect

srv_ondisconnect = [ say (format "^f1>>> ^f4Player ^f2%1(%2) ^f4left the server after ^f2%3 ^f4minutes. ^f1<<<" (getname $arg1) $arg1 (formatmillis "%hh %mm %ss" (getonline $arg1))) ]
addhandler ondisconnect srv_ondisconnect


//------ @ontext [cn] [msg] ------//
irc_text = [ ircsay (format "^f1>>> ^f2Chat by %1(%2): ^f4%3 ^f1<<<" (getname $arg1) $arg1 $arg2) ]
addhandler ontext irc_text

log_text = [ log (format ">>> Chat by %1(%2): %3 <<<" (getname $arg1) $arg1 $arg2) ]
addhandler ontext log_text


//------ onmapstart ------//
srv_mapstart = [ say (format "^f1>>> ^f4The (new) map has ^f2started^f4. Good luck and HAPPY FRAGGING!! ^f1<<<") ]
addhandler onmapstart srv_mapstart 

irc_mapstart = [ ircsay (format "^f1>>> ^f2Map changed: ^f4Mode: ^f2%1 ^f4| Map: ^f2%2 ^f4| Number of Clients: ^f2%3^f4/^f2%4 ^f4clients are currently connected^f4. ^f1<<<" (modetostr (getmode)) (getmap) (numclients) $maxclients) ]
addhandler onmapstart irc_mapstart

log_mapstart = [ log (format ">>> Map changed: Mode: %1 | Map: %2 | Number of Clients: %3/%4 clients are currently connected. <<<" (modetostr (getmode)) (getmap) (numclients) $maxclients) ]
addhandler onmapstart log_mapstart


//------ onspectator [cn] [1|0] ------//
//srv_onspec = [ say (format "%1  is %2 now" (orange (getname $arg1)) (? $arg2 "spectated" "unspectated") ) ]
//addhandler onspectator srv_onspec

//log_onspec = [ log (format "PLAYER: %1(%2) is %2 now" (getname $arg1) $arg1 (? $arg2 "spectated" "unspectated") ) ]
//addhandler onspectator log_onspec

srv_onspec = [ say (format "^f1>>> ^f4Player ^f2%1(%2) ^f4is ^f2%3 ^f4now. ^f1<<<" (getname $arg1) $arg1 (? $arg2 "spectated" "unspectated") ) ]
addhandler onspectator srv_onspec

irc_onspec = [ ircsay (format "^f1>>> ^f4Player ^f2%1(%2) ^f4is ^f2%3 ^f4now. ^f1<<<" (getname $arg1) $arg1 (? $arg2 "spectated" "unspectated") ) ]
addhandler onspectator irc_onspec

log_onspec = [ log (format ">>> Player %1(%2) is %3 now. <<<" (getname $arg1) $arg1 (? $arg2 "spectated" "unspectated") ) ]
addhandler onspectator log_onspec



//------ onsetmaster [cn] [1|0] [passhash] [authname] ------//
//srv_onmaster = [ say (format "%1 master status is ^f2%2^f7  (authname: ^f5%3^f7)" (getname $arg1) $arg2 $arg4 ) ]
//addhandler onmaster srv_onmaster

// irc_onsetmaster = [
// 	txt = (format "%1 %2(%3) %4 %5" (ircgreen "MASTER:")  (getname $arg1) $arg1 (? $arg2 "claimed" "relinquished") (? $arg2 (privname $arg2) "priveleges"))
//	if (!=s $arg4 "") [ txt = (format "%1 as '%2'" $txt $arg4) ]
//	if (!=s $arg5 "") [ txt = (format "%1 [%2]" $txt $arg5) ]
//	ircsay $txt
//]
//addhandler onsetmaster irc_onsetmaster

//log_master = [ 
//	txt = (format "MASTER: %1(%2) %3 %4" (getname $arg1) $arg1 (? $arg2 "claimed" "relinquished") (? $arg2 (privname $arg2) "priveleges"))
//	if (!=s $arg4 "") [ txt = (format "%1 as '%2'" $txt $arg4) ]
//  if (!=s $arg5 "") [ txt = (format "%1 [%2]" $txt $arg5) ]
//	log $txt
//]
//addhandler onsetmaster log_master



//------ oncommand ------//
//srv_oncommand = [ say (format "USER %1 run command '%2'" (getname $arg1) $arg2) ]
//addhandler oncommand srv_oncommand
//log_oncommand = [ echo (format "%1 #command: %2" $arg1 $arg2) ]
//addhandler oncommand log_oncommand

log_oncommand = [ log (format ">>> Player %1(%2) ran command %3 <<<" (getname $arg1) $arg1 $arg2) ]
addhandler oncommand log_oncommand



//------ onimission ------//

//------ onteamkill [cn] ------//


//------ @onsayteam [cn] [msg] ------//
log_onsayteam = [ log (format ">>> Teamchat %1(%2): %3 <<<" (getname $arg1) $arg1 $arg2) ]
addhandler onsayteam log_onsayteam

irc_onsayteam = [ ircsay (format "^f1>>> ^f4Teamchat ^f2%1(%2)^f4: ^f4%3 ^f1<<<" (getname $arg1) $arg1 $arg2) ]
addhandler onsayteam irc_onsayteam



//------ @onmastermode [cn] [mode] ------//
irc_onmastermode = [ ircsay (format "^f1>>> ^f4Player ^f2%1(%2) ^f4set mastermode to ^f2'%3'^f4. ^f1<<<" (getname $arg1) $arg1 $arg2) ]
addhandler onmastermode irc_onmastermode

log_onmastermode = [ log (format ">>> Player %1(%2) set mastermode to '%3'. <<<" (getname $arg1) $arg1 $arg2) ]
addhandler onmastermode log_onmastermode



//------ @onswitchname [cn] [newname] ------//
srv_onswitchname = [ say (format "^f1>>> ^f4Player ^f2%1(%2) ^f4is now known as ^f2%3^f4. ^f1<<<" $arg3 $arg1 $arg2 ) ]
addhandler onswitchname srv_onswitchname

irc_onswitchname = [ ircsay (format "^f1>>> ^f4Player ^f2%1(%2) ^f4is now known as ^f2%3^f4. ^f1<<<" $arg3 $arg1 $arg2 ) ]
addhandler onswitchname irc_onswitchname

log_onswitchname = [ log (format ">>> Player %1(%2) is now known as %3. <<<" $arg3 $arg1 $arg2 ) ]
addhandler onswitchname log_onswitchname


//------ onswitchmodel [cn] [mdl] ------//



//------ @onswitchteam [cn] [newteam] ------//
//irc_onswitchteam = [ ircsay (ircblue (format "%1(%2) switched to team %3" (getname $arg1) $arg1 (ircorange $arg2) ) )]
//addhandler onswitchteam irc_onswitchteam

srv_onswitchteam = [ say (format "^f1>>> ^f4Player ^f2%1(%2) ^f4has switched to team ^f2%3^f4. ^f1<<<" (getname $arg1) $arg1 $arg2 ) ]
addhandler onswitchteam srv_onswitchteam

irc_onswitchteam = [ ircsay (format "^f1>>> ^f4Player ^f2%1(%2) ^f4has switched to team ^f2%3^f4. ^f1<<<" (getname $arg1) $arg1 $arg2 ) ]
addhandler onswitchteam irc_onswitchteam

log_onswitchteam = [ log (format ">>> Player %1(%2) has switched to team '%3'. <<<" (getname $arg1) $arg1 $arg2) ]
addhandler onswitchteam log_onswitchteam



//------ onmapvote [cn] [map] [mode] ------//

//------ @onclearbans [cn] ------//
// irc_onclearbans = [ ircsay (ircblue (format "%1(%2) cleared all bans" (getname $arg1) (? (= $arg1 -1) "console" $arg1) ) ) ]
// addhandler onclearbans irc_onclearbans

// log_onclearbans = [ log (format "KB: %1(%2) cleared all bans" (getname $arg1) (? (= $arg1 -1) "console" $arg1) ) ]
// addhandler onclearbans log_onclearbans


//------ @onkick [cn] [victim] ------//
// irc_onkick = [
//	ircsay (ircred (format "KB: %1(%2) (%3) was kicked from server by %4(%5)" (getname $arg2) $arg2 (getip $arg2) (getname $arg1) (? (= $arg1 -1) "console" $arg1)))
//]
//addhandler onkick irc_onkick

//srv_onkick = [
//	say (format "^f1%1(%2) was kicked from server by %3(%4)" (getname $arg2) $arg2 (getname $arg1) (? (= $arg1 -1) "autokick" $arg1))
//]
//addhandler onkick srv_onkick

//log_onkick = [
//	log (format "KB: %1(%2) (%3) was kicked from server by %4(%5)" (getname $arg2) $arg2 (getip $arg2) (getname $arg1) (? (= $arg1 -1) "console" $arg1)) 
//]
//addhandler onkick log_onkick

//------ @onsetteam [cn] [newteam] ------//
srv_onsetteam = [ say (format "^f1>>> ^f4Player ^f2%1(%2) ^f4was forced to team ^f2%3^f4. ^f1<<<" (getname $arg1) $arg1 $arg2 ) ]
addhandler onsetteam srv_onsetteam

irc_onsetteam = [ ircsay (format "^f1>>> ^f4Player ^f2%1(%2) ^f4was forced to team ^f2%3^f4. ^f1<<<" (getname $arg1) $arg1 $arg2 ) ]
addhandler onsetteam irc_onsetteam

log_onsetteam = [ log (format ">>> Player %1(%2) was forced to team %3. <<<" (getname $arg1) $arg1 $arg2) ]
addhandler onsetteam log_onsetteam


// /* DEMOS */
//------ @onrecorddemo ------//
srv_onrecorddemo = [ say (format "^f1>>> ^f4A demo(.dmo) is ^f2recording^f4. ^f1<<<") ]
addhandler onrecorddemo srv_onrecorddemo

irc_onrecorddemo = [ ircsay (format "^f1>>> ^f4A demo(.dmo) is ^f2recording^f4. ^f1<<<") ]
addhandler onrecorddemo irc_onrecorddemo

log_onrecorddemo = [ log (format "^>>> A demo(.dmo) is recording. <<<") ]
addhandler onrecorddemo log_onrecorddemo

//------ onstopdemo ------//
srv_onstopdemo = [ say (format "^f1>>> ^f4The demo(.dmo) recording has been ^f2stopped^f4. ^f1<<<") ]
addhandler onstopdemo srv_onstopdemo

irc_onstopdemo = [ ircsay (format "^f1>>> ^f4The demo(.dmo) recording has been ^f2stopped^f4. ^f1<<<") ]
addhandler onstopdemo irc_onstopdemo

log_onstopdemo = [ log (format ">>> The demo(.dmo) recording has been stopped. <<<") ]
addhandler onstopdemo log_onstopdemo

//------ @oncleardemos [demonum] ------//
srv_oncleardemos = [ say (format "^f1>>> ^f4The demo(.dmo) directory has been ^f2cleared^f4. ^f1<<<") ]
addhandler oncleardemos srv_oncleardemos

irc_oncleardemos = [ ircsay (format "^f1>>> ^f4The demo(.dmo) directory has been ^f2cleared^f4. ^f1<<<") ]
addhandler oncleardemos irc_oncleardemos

log_oncleardemos = [ log (format ">>> The demo(.dmo) directory has been cleared. <<<") ]
addhandler oncleardemos log_oncleardemos

//------ @onlistdemos [cn] ------//
//------ @ongetdemo [cn] [demonum] ------//
// /* END OF DEMOS */



// /* BOTS */
//------ @onaddbot [skill] ------//
irc_onaddbot = [ ircsay  (format "^f1>>> ^f4A ^f2bot ^f4with ^f2%1 ^f4was ^f2added^f4. ^f1<<<" (? (> $arg1 -1) (concat "skill" $arg1) "random skill")) ]
addhandler onaddbot irc_onaddbot

log_onaddbot = [ log (format ">>> A bot with %1 was added. <<<" (? (> $arg1 - 1) (concat "skill" $arg1) "random skill")) ]
addhandler onaddbot log_onaddbot



//------ @ondelbot ------//
irc_ondelbot = [ ircsay  (format "^f1>>> ^f4A ^f2bot ^f4was ^f2removed ^f4from server %1^f4. ^f1<<<" $serverdesc) ]
addhandler ondelbot irc_ondelbot

log_ondelbot = [ log (format ">>> A bot has been removed from server %1. <<<" $serverdesc)]
addhandler ondelbot log_ondelbot




//------ onbotlimit [cn] [limit] ------//
//------ onbotbalance [cn] [balance] ------//
// /* END OF BOTS */



//------ @onpausegame [1|0] ------//
// srv_onpausegame = [ say (concatword "^f1Game is ^f0" (? $arg1 "paused" "resumed" )) ]
// addhandler onpausegame srv_onpausegame

// irc_onpausegame = [ ircsay (ircgreen (? $arg1 "Game was paused" "Game was resumed") ) ]
// addhandler onpausegame irc_onpausegame

// log_onpausegame = [ log (concatword (? $arg1 "Game was paused" "Game was resumed")) ]
// addhandler onpausegame log_onpausegame

log_onpausegame = [ log (concatword (? $arg1 ">>> Game has been paused by %1(%2). <<<" ">>> Game has been resumed by %1(%2). <<<" ( getname $arg1 ) $arg1 )) ]
addhandler onpausegame log_onpausegame




//------ onmodmap [cn] ------//
//srv_onmodmap = [ say (format "^f3%1(%2)^f7 has modified map!"  (getname $arg1) $arg1  ) ]
//addhandler onmodmap srv_onmodmap

// irc_onmodmap = [ ircsay (ircred (format "%1(%2) has  modified map!" (getname $arg1) $arg1 ) ) ]
// addhandler onmodmap irc_onmodmap

// log_onmodmap = [ log (format "MODMAP: %1(%2) has  modified map!" (getname $arg1) $arg1 ) ]
// addhandler onmodmap log_onmodmap



//------ onmute [1|0] [cn] ------//
// irc_onmute = [ ircsay (format "%1(%2) has been %3" (getname $arg2) $arg2 (? $arg1 "muted" "unmuted")) ]
// addhandler onmute irc_onmute

// log_onmute = [ log (format "%1(%2) has been %3" (getname $arg2) $arg2 (? $arg1 "muted" "unmuted")) ]
// addhandler onmute log_onmute

// svr_onmute = [
//	say (format "^f1Player ^f0%1(%2) ^f1has been ^f0%3" (getname $arg2) $arg2 (? $arg1 "muted" "unmuted"))
//	if $arg1 [  
//		pm $arg2 "^f1You has been ^f0muted^f1. Nobody hears your scream"	
//	] [
//		pm $arg2 "^f1You has been ^f0unmuted^f1. Please be polite"
//	]
	
//]
// addhandler onmute svr_onmute


//shows "usage error" for  command
usage_error = [ 
	pm $arg1 (concatword "^f1>>> ^f2Internal Error: " (usage $arg2) " ^f1<<<")
]
addhandler oncommandusageerror usage_error

//command not found
unknown_command = [ 
	pm $arg1 (concatword "^f4>>> ^f4The command ^f3" $commandchar "^f4" $arg2 " ^f4was not found. Type ^f3#^f4help for a list of all available commands with your current privilege level. ^f1<<<")
]
addhandler oncommandunknown unknown_command

//permissions error
perm_error = [ 
	pm $arg1 (concatword "^f1>>> ^f4You don't have enough ^f2permissions ^f4to run ^f3" $commandchar "^f4" $arg2 "^f4. Raise your privilege up to ^f6admin^f4, to use all server commands. ^f1<<<")
]
addhandler oncommandpermerror perm_error



//shows "usage" for command
irc_usage = [ 
	result (concatword "^f1>>> ^f2Usage: ^f1<<<" (irc_commandhelp $arg1))
]

//shows "usage error" for  command
irc_usage_error = [ 
	ircsay (format "^f1>>> ^f2Internal Error: %1 ^f1<<<" (irc_usage $arg2))
]
addhandler irc_oncommandusageerror irc_usage_error

//command not found
irc_unknown_command = [ 
	ircsay (format "^f1>>> ^f4This command hasn't been found. Type ^f2<servername> help ^f4to display the ^f2commands list^f4. ^f1<<<")
]
addhandler irc_oncommandunknown irc_unknown_command

//permissions error
irc_perm_error = [ 
	ircsay (format "^f1>>> ^f4You don't have enough permissions to run ^f2" $arg2 "^f4. Raise your privilege level to ^f2Operator ^f4to use this command. ^f1<<<" )
]
addhandler irc_oncommandpermerror irc_perm_error


// show error message aboute mute to player
svr_onmutemodetrigger = [
	msg = "^f1>>> ^f4Your ^f2privileges class ^f4has been ^f2muted^f4. You can't ^f2speak ^f4this moment. ^f1<<<"
	case $mutemode 1 [
		msg = "^f1>>> ^f4Spectators are ^f2disallowed ^f4to ^f2speak^f4. ^f1<<<"
	] 2 [
		msg = "^f1>>> ^f4Only ^f0masters ^f4and ^f6admins ^f4are ^f2allowed ^f4to ^f2speak^f4. ^f1<<<"
	] 3 [
		msg = "^f1>>> ^f4Only ^f6admins ^f4are ^f2allowed ^f4to ^f2speak^f4. ^f1<<<"
	]
	pm $arg1 $msg
]
addhandler onmutemodetrigger svr_onmutemodetrigger

// resume countdown
srv_onresumegame  = [
	say ( format "^f1>>> ^f4Game will continue in ^f2%1 ^f4seconds, prepare yourself. ^f1<<<" $resumedelay)
	
	asleep (* $resumedelay 1000) [
		say (format "^f1>>> ^f2Game is ^f2resumed! ^f3GO! ^f1<<<")
	]
	
	loop n (- $resumedelay 1) [
		asleep (* (+ $n 1) 1000 ) [
			say (format "^f1>>> ^f4Continue in ^f2%1 ^f4seconds... ^f1<<<" (- $resumedelay (+ @n 1)))
		]
	]
]
addhandler onresumegame srv_onresumegame					

srv_onovertime = [
	overtime_minutes = (div $overtime 60)
	overtime_seconds = (- $overtime (* $overtime_minutes 60))
	msg = (concat "^f1>>> ^f4Teams are ^f2tied^f4." "^f2Overtime: ^f4It's^f2" $overtime_minutes "^f4min")
	if (!= $overtime_seconds 0) [
		msg = (concat $msg "and^f2" $overtime_seconds "^f4sec ^f1<<<")
	]
	say $msg
]
addhandler onovertime srv_onovertime


// srv_onghosttrigger = [
//	pm $arg1 "^f3You are in ghost mode and disallowed to edit"
// ]
// addhandler onghosttrigger srv_onghosttrigger

// srv_onmutetrigger = [
//	pm $arg1 "^f3You are muted, no one hear your scream"
// ]
// addhandler onmutetrigger srv_onmutetrigger

