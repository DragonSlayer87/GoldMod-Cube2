// mute insulters - mute player with offensive language + only, if normal text, teamchat-muting dont works
// made by /BudSpencer (2016)


enable_mute_module = 1
enable_muting_with_string = 1
enable_kicking_with_string = 0

player_name = ( getname $arg1 )
player_cn =  ( getcn $arg1 )


mute_insulters_system_core = [

if ( = $enable_mute_module 1 ) [
player_string_disabled = ( getvalue $arg2 ( at $DISALLOWED-WORDS $arg2 ))
player_name = ( getname $arg1 )	
player_cn = ( getcn $arg1 )
player_string = $arg2 

if ( = ( strstr $DISALLOWED-WORDS $player_string ) -1 ) [
pm $arg1 (format "^f1>>> ^f4You've been muted, ^f4because you use ^f2offensive language^f4. Attention what you say on that ^f2server^f4. ^f1<<<")
ircsay (format "^f1>>> ^f4Player ^f2%1(%2) ^f4said ^f2'%3' ^f4and is ^f2muted ^f4now. ^f1<<<" $player_name $player_cn $player_string )
log (format ">>> Player %1(%2) said '%3' and is muted now. <<<" $player_name $player_cn $player_string )
sleep 50 [ mute $arg1 1 ]
	
	]
	
	if ( = $enable_kicking_with_string 1 ) [
	pm $arg1 (format "^f1>>> ^f4You've said terrible things to other players. ^f4The ^f2administrator ^f4decided, that you are ^f2kicked out ^f4now. ^f2Happy flight^f4! ^f1<<<")
	ircsay (format "^f1>>> ^f4Player ^f2%1(%2) ^f4got ^f2kicked ^f4for his bad words. ^f1<<<" $player_name $player_cn )
	log (format ">>> Player %1(%2) got kicked for his bad words. <<<" $player_name $player_cn )
	sleep 50 [ kick $arg1 3600000 ] // kicks player for 1 hour - if no time, for 3 hours
	
		]
	]
]

addhandler ontext mute_insulters_system_core
addhandler onsayteam mute_insulters_system_core // don't work