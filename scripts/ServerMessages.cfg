//here standart events' handlers are described

// connect messages

connect_player = [

if ( checkipbymask $ip "192.168.*.*" ) [

say ( format "^f7Player ^f3%1(admin) ^f7connected to server from ^f4localhost^f7. Language: ^f4%4^f7" ( getname $arg1 ) ( getlanguageen $arg1 ) )

] [

if ( && ( = ( isregmaster ( getip $arg1 ) ) 0 ) ( = ( isregadmin ( getip $arg1 ) ) 0 ) ) [ say ( format "^f7Player ^f3%1 ^f7connected to server from ^f4%2, %3^f7. Language: ^f4%4^f7" ( getname $arg1 ) ( getcountry ( getip $arg1 ) ) ( getcontinenten ( getcountry ( getip $arg1 ) ) ) ( getlanguageen $arg1 ) ) ] 

] [

if ( = ( isregmaster ( getip $arg1 ) ) 1 ) [ say ( format "^f7Player ^f3%1(master) ^f7connected to server from ^f4%2, %3^f7. Language: ^f4%4^f7" ( getname $arg1 ) ( getcountry ( getip $arg1 ) ) ( getcontinenten ( getcountry ( getip $arg1 ) ) ) ( getlanguageen $arg1 ) ) ] 

] [

if ( = ( isregadmin ( getip $arg1 ) ) 1 ) [ say ( format "^f7Player ^f3%1(admin) ^f7connected to server from ^f4%2, %3^f7. Language: ^f4%4^f7" ( getname $arg1 ) ( getcountry ( getip $arg1 ) ) ( getcontinenten ( getcountry ( getip $arg1 ) ) ) ( getlanguageen $arg1 ) ) ] 
	
	]
	
]

addhandler "onconnect" connect_player

//shows "usage error" for  command
usage_error = [ 
	pm $arg1 (concatword "^f1>>> ^f2Internal Error: " (usage $arg2) " ^f1<<<")
]
addhandler oncommandusageerror usage_error

//command not found
unknown_command = [ 
	pm $arg1 (concatword "^f4>>> ^f4The command ^f3" $commandchar "^f4" $arg2 " ^f4was not found. Type ^f3#^f4help for a list of all available commands with your current privilege level. ^f1<<<")
]
addhandler oncommandunknown unknown_command

//permissions error
perm_error = [ 

perm = (getperm $arg1)
		res = ""
		loopcommands cmd $perm [
			res = (concatword $res " #" $cmd) 
			
	case $perm 2 [
	pm $arg1 (concatword "^f1>>> ^f4You don't have enough ^f2permissions ^f4to run ^f3" $commandchar "^f4" $arg2 "^f4. Raise your privilege up to ^f0master^f4, to use that server command. ^f1<<<")
	
	] 3 [
	
	pm $arg1 (concatword "^f1>>> ^f4You don't have enough ^f2permissions ^f4to run ^f3" $commandchar "^f4" $arg2 "^f4. Raise your privilege up to ^f6admin^f4, to use that server command. ^f1<<<")
		]
		
	]
	
]

addhandler oncommandpermerror perm_error



//shows "usage" for command
irc_usage = [ 
	result (concatword "^f1>>> ^f2Usage: ^f1<<<" (irc_commandhelp $arg1))
]

//shows "usage error" for  command
irc_usage_error = [ 
	ircsay (format "^f1>>> ^f2Internal Error: %1 ^f1<<<" (irc_usage $arg2))
]
addhandler irc_oncommandusageerror irc_usage_error

//command not found
irc_unknown_command = [ 
	ircsay (format "^f1>>> ^f4This command hasn't been found. Type ^f2<servername> help ^f4to display the ^f2commands list^f4. ^f1<<<")
]
addhandler irc_oncommandunknown irc_unknown_command

//permissions error
irc_perm_error = [ 
	ircsay (format "^f1>>> ^f4You don't have enough permissions to run ^f2" $arg2 "^f4. Raise your privilege level to ^f2Operator ^f4to use this command. ^f1<<<" )
]
addhandler irc_oncommandpermerror irc_perm_error


// show error message aboute mute to player
svr_onmutemodetrigger = [
	msg = "^f1>>> ^f4Your ^f2privileges class ^f4has been ^f2muted^f4. You can't ^f2speak ^f4this moment. ^f1<<<"
	case $mutemode 1 [
		msg = "^f1>>> ^f4Spectators are ^f2disallowed ^f4to ^f2speak^f4. ^f1<<<"
	] 2 [
		msg = "^f1>>> ^f4Only ^f0masters ^f4and ^f6admins ^f4are ^f2allowed ^f4to ^f2speak^f4. ^f1<<<"
	] 3 [
		msg = "^f1>>> ^f4Only ^f6admins ^f4are ^f2allowed ^f4to ^f2speak^f4. ^f1<<<"
	]
	pm $arg1 $msg
]
addhandler onmutemodetrigger svr_onmutemodetrigger

// resume countdown
srv_onresumegame  = [
	say ( format "^f1>>> ^f4Game will continue in ^f2%1 ^f4seconds, prepare yourself. ^f1<<<" $resumedelay)
	
	asleep (* $resumedelay 1000) [
		say (format "^f1>>> ^f2Game is ^f2resumed! ^f3GO! ^f1<<<")
	]
	
	loop n (- $resumedelay 1) [
		asleep (* (+ $n 1) 1000 ) [
			say (format "^f1>>> ^f4Continue in ^f2%1 ^f4seconds... ^f1<<<" (- $resumedelay (+ @n 1)))
		]
	]
]
addhandler onresumegame srv_onresumegame					

srv_onovertime = [
	overtime_minutes = (div $overtime 60)
	overtime_seconds = (- $overtime (* $overtime_minutes 60))
	msg = (concat "^f1>>> ^f4Teams are ^f2tied^f4." "^f2Overtime: ^f4It's^f2" $overtime_minutes "^f4min")
	if (!= $overtime_seconds 0) [
		msg = (concat $msg "and^f2" $overtime_seconds "^f4sec ^f1<<<")
	]
	say $msg
]
addhandler onovertime srv_onovertime


// srv_onghosttrigger = [
//	pm $arg1 "^f3You are in ghost mode and disallowed to edit"
// ]
// addhandler onghosttrigger srv_onghosttrigger

srv_onmutetrigger = [

pm $arg1 ( format "^f3You are muted, no one hear your scream" )

]

addhandler onmutetrigger srv_onmutetrigger

