//here standart events' handlers are described

// connect messages

connect_player = [

pip = ( getip $arg1 )

if ( checkipbymask $pip "192.168.*.*" ) [

say ( format "^f7Player ^f3%1(admin) ^f7connected to server from ^f4localhost^f7. Language: ^f4English^f7" ( getname $arg1 ) )
ircsay ( format "^f7Player ^f3%1(admin) ^f7connected to server from ^f4localhost^f7. Language: ^f4English^f7" ( getname $arg1 ) )
echo ( format "^f7Player ^f3%1(admin) ^f7connected to server from ^f4localhost^f7. Language: ^f4English^f7" ( getname $arg1 ) )

] [

if ( && ( = ( isregmaster ( getip $arg1 ) ) 0 ) ( = ( isregadmin ( getip $arg1 ) ) 0 ) ) [ 

saytonormal ( format "^f7Player ^f3%1 ^f7connected to server from ^f4%2, %3^f7. Language: ^f4%4^f7" ( getname $arg1 ) ( getcountry ( getip $arg1 ) ) ( getcontinenten ( getcountry ( getip $arg1 ) ) ) ( getlanguageen $arg1 ) )
saytomaster ( format "^f7Player ^f3%1 ^f7connected to server from ^f4%2, %3^f7. Language: ^f4%4^f7 (Client Number: ^f4%5^f7)" ( getname $arg1 ) ( getcountry ( getip $arg1 ) ) ( getcontinenten ( getcountry ( getip $arg1 ) ) ) ( getlanguageen $arg1 ) ( getcn $arg1 ) ) 
saytoadmin ( format "^f7Player ^f3%1 ^f7connected to server from ^f4%2, %3^f7. Language: ^f4%4^f7 (IP-Adress: ^f4%5 ^f7| Client Number: ^f4%6^f7)" ( getname $arg1 ) ( getcountry ( getip $arg1 ) ) ( getcontinenten ( getcountry ( getip $arg1 ) ) ) ( getlanguageen $arg1 ) ( getip $arg1 ) ( getcn $arg1 ) )  
echo ( format "^f7Player ^f3%1 ^f7connected to server from ^f4%2, %3^f7. Language: ^f4%4^f7 (IP-Adress: ^f4%5 ^f7| Client Number: ^f4%6^f7)" ( getname $arg1 ) ( getcountry ( getip $arg1 ) ) ( getcontinenten ( getcountry ( getip $arg1 ) ) ) ( getlanguageen $arg1 ) ( getip $arg1 ) ( getcn $arg1 ) )  
ircsay ( format "^f7Player ^f3%1 ^f7connected to server from ^f4%2, %3^f7. Language: ^f4%4^f7 (Client Number: ^f4%5^f7)" ( getname $arg1 ) ( getcountry ( getip $arg1 ) ) ( getcontinenten ( getcountry ( getip $arg1 ) ) ) ( getlanguageen $arg1 ) ( getcn $arg1 ) ) 

] [
	
if ( = ( isregmaster ( getip $arg1 ) ) 1 ) [ 

saytonormal ( format "^f7Player ^f3%1(master) ^f7connected to server from ^f4%2, %3^f7. Language: ^f4%4^f7" ( getname $arg1 ) ( getcountry ( getip $arg1 ) ) ( getcontinenten ( getcountry ( getip $arg1 ) ) ) ( getlanguageen $arg1 ) ) 
saytomaster ( format "^f7Player ^f3%1(master) ^f7connected to server from ^f4%2, %3^f7. Language: ^f4%4^f7 (Client Number: ^f4%5^f7)" ( getname $arg1 ) ( getcountry ( getip $arg1 ) ) ( getcontinenten ( getcountry ( getip $arg1 ) ) ) ( getlanguageen $arg1 ) ( getcn $arg1 ) )  
saytoadmin ( format "^f7Player ^f3%1(master) ^f7connected to server from ^f4%2, %3^f7. Language: ^f4%4^f7 (IP-Adress: ^f4%5 ^f7| Client Number: ^f4%6^f7)" ( getname $arg1 ) ( getcountry ( getip $arg1 ) ) ( getcontinenten ( getcountry ( getip $arg1 ) ) ) ( getlanguageen $arg1 ) ( getip $arg1 ) ( getcn $arg1 ) )   
echo ( format "^f7Player ^f3%1(master) ^f7connected to server from ^f4%2, %3^f7. Language: ^f4%4^f7 (IP-Adress: ^f4%5 ^f7| Client Number: ^f4%6^f7)" ( getname $arg1 ) ( getcountry ( getip $arg1 ) ) ( getcontinenten ( getcountry ( getip $arg1 ) ) ) ( getlanguageen $arg1 ) ( getip $arg1 ) ( getcn $arg1 ) )   
ircsay ( format "^f7Player ^f3%1(master) ^f7connected to server from ^f4%2, %3^f7. Language: ^f4%4^f7 (Client Number: ^f4%5^f7)" ( getname $arg1 ) ( getcountry ( getip $arg1 ) ) ( getcontinenten ( getcountry ( getip $arg1 ) ) ) ( getlanguageen $arg1 ) ( getcn $arg1 ) )   

] [

if ( = ( isregadmin ( getip $arg1 ) ) 1 ) [ 

saytonormal ( format "^f7Player ^f3%1(admin) ^f7connected to server from ^f4%2, %3^f7. Language: ^f4%4^f7" ( getname $arg1 ) ( getcountry ( getip $arg1 ) ) ( getcontinenten ( getcountry ( getip $arg1 ) ) ) ( getlanguageen $arg1 ) )
saytomaster ( format "^f7Player ^f3%1(admin) ^f7connected to server from ^f4%2, %3^f7. Language: ^f4%4^f7 (Client Number: ^f4%5^f7)" ( getname $arg1 ) ( getcountry ( getip $arg1 ) ) ( getcontinenten ( getcountry ( getip $arg1 ) ) ) ( getlanguageen $arg1 ) ( getcn $arg1 ) ) 
saytoadmin ( format "^f7Player ^f3%1(admin) ^f7connected to server from ^f4%2, %3^f7. Language: ^f4%4^f7 (IP-Adress: ^f4%5 ^f7| Client Number: ^f4%6^f7)" ( getname $arg1 ) ( getcountry ( getip $arg1 ) ) ( getcontinenten ( getcountry ( getip $arg1 ) ) ) ( getlanguageen $arg1 ) ( getip $arg1 ) ( getcn $arg1 ) )   
echo ( format "^f7Player ^f3%1(admin) ^f7connected to server from ^f4%2, %3^f7. Language: ^f4%4^f7 (IP-Adress: ^f4%5 ^f7| Client Number: ^f4%6^f7)" ( getname $arg1 ) ( getcountry ( getip $arg1 ) ) ( getcontinenten ( getcountry ( getip $arg1 ) ) ) ( getlanguageen $arg1 ) ( getip $arg1 ) ( getcn $arg1 ) )   
ircsay ( format "^f7Player ^f3%1(admin) ^f7connected to server from ^f4%2, %3^f7. Language: ^f4%4^f7 (Client Number: ^f4%5^f7)" ( getname $arg1 ) ( getcountry ( getip $arg1 ) ) ( getcontinenten ( getcountry ( getip $arg1 ) ) ) ( getlanguageen $arg1 ) ( getcn $arg1 ) ) 

				]
				
			]
			
		]
		
	]
	
]

addhandler "onconnect" connect_player


srv_disc = [

say ( format "Player ^f3%1(%2) ^f7is ^f4disconnected^f7." ( getname $arg1 ) $arg1 )
ircsay ( format "Player ^f3%1(%2) ^f7is ^f4disconnected^f7." ( getname $arg1 ) $arg1 )
echo ( format "Player ^f3%1(%2) ^f7is ^f4disconnected^f7." ( getname $arg1 ) $arg1 )

]
addhandler "ondisconnect" srv_disc

srv_text = [

ircsay ( format "^f7Chat ^f7(^f3%1^f7(^f3%2^f7)): ^f4%3" ( getname $arg1 ) ( getcn $arg1 ) $arg2 )
echo ( format "^f7Chat ^f7(^f3%1^f7(^f3%2^f7)): ^f4%3" ( getname $arg1 ) ( getcn $arg1 ) $arg2 )

]

addhandler "ontext" srv_text 

srv_teamchat = [

ircsay ( format "^f7Teamchat ^f7(^f3%1^f7(^f3%2^f7)): ^f4%3" ( getname $arg1 ) ( getcn $arg1 ) $arg2 )
echo ( format "^f7Teamchat ^f7(^f3%1^f7(^f3%2^f7)): ^f4%3" ( getname $arg1 ) ( getcn $arg1 ) $arg2 )

]

addhandler "onsayteam" srv_teamchat



//shows "usage error" for  command
usage_error = [ 
	pm $arg1 ( concatword "^f1>>> ^f2Internal Error: " (usage $arg2) " ^f1<<<" )
]
addhandler oncommandusageerror usage_error

//command not found
unknown_command = [ 
	pm $arg1 ( concatword "^f4>>> ^f4The command ^f3" $commandchar "^f4" $arg2 " ^f4was not found. Type ^f3#^f4help for a list of all available commands with your current privilege level. ^f1<<<" )
]
addhandler oncommandunknown unknown_command

//permissions error
perm_error = [ 
	
	pm $arg1 ( concatword "^f7You don't have enough ^f3permissions ^f7to run ^f4" $commandchar "^f4" $arg2 "^f7. Raise your privilege up to use that server command." )
	
]

addhandler oncommandpermerror perm_error



//shows "usage" for command
irc_usage = [ 
	result ( concatword "^f1>>> ^f2Usage: ^f1<<<" ( irc_commandhelp $arg1 ) )
]

//shows "usage error" for  command
irc_usage_error = [ 
	ircsay ( format "^f1>>> ^f2Internal Error: %1 ^f1<<<" ( irc_usage $arg2 ) )
]
addhandler irc_oncommandusageerror irc_usage_error

//command not found
irc_unknown_command = [ 
	ircsay ( format "^f7This command hasn't been found. Type ^f3<servername>, help ^f7to display the ^f4commands list^f7." )
]
addhandler irc_oncommandunknown irc_unknown_command

//permissions error
irc_perm_error = [ 
	ircsay ( format "^f7You don't have enough permissions to run ^f3" $arg2 "^f7. Raise your privilege level to ^f4IRC Operator ^f7to use this command." )
]
addhandler irc_oncommandpermerror irc_perm_error


// show error message aboute mute to player
svr_onmutemodetrigger = [ msg = "All players with your ^f3privilege level ^f7have been ^f4muted^f7. You can't ^f4speak ^f7right now." ; case $mutemode 1 [ msg = "^f7Spectators are ^f3disallowed ^f7to ^f4speak^f7." ] 2 [ msg = "^f7Only ^f3masters ^f7and ^f3admins ^f7are ^f4allowed ^f7to ^f4speak^f7." ] 3 [ msg = "^f7Only ^f3admins ^f7are ^f4allowed ^f7to ^f4speak^f7." ] pm $arg1 $msg ]
addhandler onmutemodetrigger svr_onmutemodetrigger

// resume countdown
srv_onresumegame  = [

	say ( format "^f7Game will continue in ^f3%1 ^f7seconds, prepare ^f4yourself^f7." $resumedelay )
	
	asleep ( * $resumedelay 1000 ) [
		say ( format "^f7Game is ^f3resumed^f7. ^f4Have Fun^f7!" )
	]
	
	loop n ( - $resumedelay 1 ) [
		asleep ( * ( + $n 1 ) 1000 ) [
			say ( format "^f7Continue in ^f3%1 ^f7seconds ..." ( - $resumedelay ( + @n 1 ) ) )
		]
	]
]

addhandler onresumegame srv_onresumegame					

srv_onovertime = [
	overtime_minutes = ( div $overtime 60 )
	overtime_seconds = ( - $overtime ( * $overtime_minutes 60 ) )
	msg = ( concat "^f7Teams are ^f3tied^f7." " ^f7Overtime: ^f4" $overtime_minutes "^f7minutes" )
	if ( != $overtime_seconds 0 ) [
		msg = ( concat $msg "and ^f4" $overtime_seconds "^f7seconds." )
	]
	say $msg
]

addhandler onovertime srv_onovertime


// srv_onghosttrigger = [
//	pm $arg1 "^f3You are in ghost mode and disallowed to edit"
// ]
// addhandler onghosttrigger srv_onghosttrigger

srv_onmutetrigger = [

pm $arg1 ( format "^f7Your ^f3text messages ^f7are ^f4blocked ^f7right now." )

]

addhandler onmutetrigger srv_onmutetrigger


srv_onkick = [

		cn1 = $arg1 
		cn2 = $arg2 
		
		name_1 = ( getname $cn1 )
		name_2 = ( getname $cn2 )
		
	if ( > $cn1 -1 ) [
		
		say ( format "^f7Player ^f3%1(%2) ^f7has kicked Player ^f4%3(%4)^f7. Good Bye!" $name_1 $cn1 $name_2 $cn2 )
		
	] [
	
		say ( format "The ^f3Server(-1) ^f7kicked ^f7Player ^f4%1(%2)^f7. (autokick)" $name_2 $cn2 )
		
	]
	
]

addhandler "onkick" srv_onkick


srv_onrecorddemo = [ say ( format "^f7Demo ^f3recording ^f7has ^f4started^f7." ) ]

addhandler "onrecorddemo" srv_onrecorddemo
